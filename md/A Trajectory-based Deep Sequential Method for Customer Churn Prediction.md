# A Trajectory-based Deep Sequential Method for Customer Churn Prediction

## ABSTRACT

Customer churn prediction is a pivotal issue in business marketing. Many researches have been pursuing more efficient features and techniques for it. Rapid growth of mobile Internet devices has generated large amounts of customer trajectory data, which contains abundant customer behavior patterns and contributes to many business actions. In this paper we propose a trajectory-based deep sequential method called TR-LSTM for customer churn prediction to mining the customer behavior pattern behind trajectory data. The method extracts three types of trajectory based features and applied the long short-term memory neural network (LSTM) to conduct sequential modeling. Experimental results on real-world customer trajectory data sets demonstrate that the proposed TR-LSTM obtains better performance than all baseline methods. Our method provides a new tool of churn prediction for both academics and practitioners.

客户流失预测是企业营销中的一个关键问题。许多研究一直在寻求更高效的特性和技术。移动互联网设备的快速增长产生了大量的客户轨迹数据，其中包含了丰富的客户行为模式，促成了许多商业行为。本文提出了一种基于轨迹的深度序列客户流失预测方法，即TR-LSTM，用于挖掘轨迹数据背后的客户行为模式。该方法提取三种基于轨迹的特征，应用长短期记忆神经网络(LSTM)进行序列建模。在真实客户轨迹数据集上的实验结果表明，所提出的TR-LSTM方法比所有基线方法都具有更好的性能。我们的方法为学者和从业人员提供了一个新的人员流失预测工具。

## 1. INTRODUCTION

Customer churn refers to customers' terminating the relationship with a company providing products or services. Related studies have showed that customer retaining cost is less than new customer acquisition cost [1]. More and more companies are gradually shifting their strategy from pursuing new customers to retaining existing customers. Churn prediction is the procedure to identify the customer segment with high churn risk. Then the companies could engage them with targeted retention offers to reduce economic losses. Neslin et al. have demonstrated that small improvement of churn prediction performance leads to a lot more profit [2]. Churn prediction has become one of the most important marketing campaigns nowadays.

客户流失是指客户与提供产品或服务的公司终止关系。相关研究表明，客户保留成本小于新客户获取成本[1]。越来越多的公司正逐渐将战略从追求新客户转向保留现有客户。流失预测是识别具有高流失风险的客户群体的过程。然后，这些公司可以与他们进行有针对性的挽留，以减少经济损失。Neslin等人已经证明，用户流失预测性能的微小改善会带来更多的利润[2]。流失预测已经成为当今最重要的营销活动之一。

Over the past few decades, customer churn prediction has received extensive research attention. Researchers have utilized different customer data to find potential churners, which includes demographic, behavior data and so on [3-6]. Generally, the richer information the customer data contains, the more accurate the churn prediction model will be. For instance, current research demonstrated that incorporating additional customer/company contacting data (e.g. Email text) in churn prediction model could improve the predictive performance and obtain additional business profit [6].

在过去的几十年里，客户流失预测受到了广泛的研究关注。研究者利用不同的客户数据来寻找潜在的客户，包括人口统计数据、行为数据等[3-6]。通常，客户数据包含的信息越丰富，流失预测模型就越准确。例如，目前的研究表明，在流失预测模型中加入额外的客户/公司联系数据(例如电子邮件文本)可以提高预测性能，获得额外的业务利润[6]。

Nowadays, wide spread of mobile Internet devices makes it available for companies to acquire massive customer trajectory data. Customer trajectory is a trace generated by customer in geographical spaces and is usually represented by a series of chronologically ordered points. Each point in the trajectory records location, time and additional marked variable of some customer events (e.g. check-in in social media) [7]. Customer trajectory data contains rich information of their behavior patterns and thus provides a new perspective to customer analytics. It fosters different business actions, such as online advertisement recommendation [8] and next location prediction [9]. However, we have so far not witnessed related researches that applied trajectory data to churn prediction.

如今，移动互联网设备的广泛普及，使得企业可以获取大量的客户轨迹数据。客户轨迹是客户在地理空间中生成的轨迹，通常由一系列按时间顺序排列的点表示。轨迹中的每个点都记录了一些客户活动的位置、时间和附加标记变量(如在社交媒体签到)[7]。客户轨迹数据包含了客户行为模式的丰富信息，为客户分析提供了新的视角。它培育不同的商业行为，如在线广告推荐[8]和下一个位置预测[9]。但是，目前还没有将轨迹数据应用于流失率预测的相关研究。


In this light, we incorporate the trajectory data into customer churn prediction and propose a trajectory-based deep sequential method called TR-LSTM. In order to mining the rich spatiotemporal patterns of each customer, the new method extracts three types of features --- customer value, spatial and semantic features from the trajectory data. Then, the multivariate feature sequences are applied to build prediction model based on a deep sequential framework --- long short-term memory neural network (LSTM) [10]. LSTM is one of state-of-art data mining techniques, which can handle the complex non-linear spatio-temporal relations [11] in trajectory data. We conduct some benchmark experiments to verify the effectiveness of our proposed method. The results show our method outperforms all the baseline methods used in the experiments.

基于此，我们将轨迹数据引入到客户流失预测中，提出了基于轨迹的深度序列方法TR-LSTM。为了挖掘每个客户丰富的时空模式，新方法从轨迹数据中提取客户价值、空间特征和语义特征。然后，利用多元特征序列建立基于深度序列框架——长短期记忆神经网络[10]的预测模型。LSTM是一种先进的数据挖掘技术，能够处理轨道数据中复杂的非线性时空关系。我们做了一些基准实验来验证我们提出的方法的有效性。实验结果表明，该方法优于实验中使用的所有基线方法。

## 2. RELATED WORK

### 2.1 Data Dimension

Various types of customer data have been exploited in churn prediction. The mainstream data types belong to the structured data. Customer demographic data (e.g. age, gender and income) [3] and behavior data (e.g. Call Detail Records [4] and RFM [5]) are two typical traditional data types in churn prediction. Recent years, unstructured data is also used to churn prediction. Representative unstructured data for churn prediction is textual data. For instance, Amiri and Daumé[12] learned the churn indicator representations from micro-post text to detect churn in micro-blogs and obtained accuracy improvement. De Caigny et al. [6] also included the textual information in financial churn prediction and increased prediction performance.

在客户流失预测中，已经利用了各种类型的客户数据。主流数据类型属于结构化数据。客户人口统计数据(如年龄、性别和收入)[3]和行为数据(如呼叫详情记录[4]和RFM[5])是流失预测中两种典型的传统数据类型。近年来，非结构化数据也被用于流失预测。用于流失预测的代表性非结构化数据是文本数据。例如，Amiri和Daumé[12]从微博文本中学习了流失指标表示，用于检测微博中的流失，从而提高了准确率。De Caigny等人的[6]也将文本信息包括在金融流失预测和提高预测性能中。

Besides direct usage, the original data are often transformed into various patterns. For example, social-network patterns become increasingly important complements to churn prediction. Kawale et al. [13] proposed an online game churn prediction model by adding the players' social influence into individual engagement, and found a significant accuracy improvement than the model only involved with individual engagement. However, to the best of our knowledge, incorporating the trajectory data into churn prediction so far remains to be investigated.

除了直接使用外，原始数据经常被转换成各种模式。例如，社交网络模式成为流失预测的重要补充。Kawale等人提出了一个在线游戏流失预测模型，通过将玩家的社会影响添加到个人粘性中，发现其准确性比只涉及个人粘性的模型有显著提高。然而，据我们所知，将轨迹数据纳入到流失率预测中仍有待研究。

### 2.2 Model Dimension

Customer churn prediction can be treated as a binary classification task. Therefore, lots of data mining techniques are widely applied to build the churn prediction model. For instance, Prasad and Madhavi [14] exploited two types of decision tree methods CART (classification and regression tree) and C5.0 in banking customer churn prediction. Kirui et al. [15] compared two probability-based method namely Naïve Bayes and Bayesian Network in churn prediction of mobile telephone sector. Xia et al. [16] demonstrated the superiority of support vector machine on two specific telecommunication data sets in comparison with logistic regression, C4.5 decision tree and Naïve Bayes. Beside the single model, ensemble techniques also become popular in churn prediction recently. For example, Lu et al. [17] used Boosting to improve the churn prediction capacity and get better performance than logistic regression.

客户流失预测可以看作是一个二元分类任务。因此，大量的数据挖掘技术被广泛应用于人员流失预测模型的建立。例如，Prasad和Madhavi[14]在银行客户流失预测中利用了CART (classification and regression tree)和C5.0两种决策树方法。Kirui等人[15]比较了两种基于概率的方法Naïve Bayes和Bayesian Network在移动电话行业流失预测中的应用。Xia等人[16]在两个具体的电信数据集上论证了支持向量机与logistic回归、C4.5决策树和Naïve Bayes相比的优越性。近年来，除了单一模型外，集成技术在流失预测中也很受欢迎。例如，Lu et al.[17]使用Boosting提高了流失预测能力，得到了比logistic回归更好的性能。

As one of the most advanced data mining techniques, deep learning has been gradually applied to churn prediction for the last few years. For instance, Umayaparvathi et al. [18] found the deep learning method without hand-picked features performs as good as traditional methods in two telecom churn prediction tasks, which verified the capacity of automatically extracting good features or representations in deep learning. Due to this capacity, the deep learning could not only partly avoid manual feature engineering, but also be good at handling data with complex structure like image [19], text [12] and sequence [20]. The trajectory is a typical sequence data with complex non-linear spatio-temporal relations, which brings lots of inconveniences to classical data mining techniques [11]. Therefore, we could state that the deep learning method is feasible in churn prediction based on trajectories.

深度学习作为最先进的数据挖掘技术之一，近年来逐渐被应用到流失预测中。例如Umayaparvathi等人[18]发现，在两个电信用户流失预测任务中，不需要手工挑选特征的深度学习方法的表现与传统方法一样好，验证了深度学习自动提取良好特征或表征的能力。由于这种能力，深度学习不仅在一定程度上避免了人工特征工程，而且擅长处理图像[19]、文本[12]、序列[20]等结构复杂的数据。轨迹数据是一种典型的序列数据，具有复杂的非线性时空关系，给传统的数据挖掘技术[11]带来了诸多不便。因此，我们可以说，深度学习方法在基于轨迹的流失预测中是可行的。

## 3. METHODOLOGY

## 4. EXPERIMENTS

## 5. CONCLUSION

Customer churn prediction is a crucial issue for marketing community. With the booming Internet and location-based services, customer trajectory data is available for many companies. Trajectory data contains rich information about customers and there is the great potential of incorporating trajectories into churn prediction. Thus, we propose a trajectory-based deep sequential method TR-LSTM to carry out churn prediction. In the new method TR-LSTM, three types of trajectory-based features are extracted from trajectory data set, then the LSTM neural network is applied to conduct the sequential modeling. We further launch empirical experiments on a real-world customer data set. Our method obtains the best performance among all the techniques. The result also shows that the strength of our method comes from the trajectory-based features, sequential modeling and collaborative modeling. For future work, we will explore more effective indices, as well as different representations of features.

客户流失预测是营销社区的一个关键问题。随着互联网和基于位置的服务的蓬勃发展，许多公司都可以获得客户轨迹数据。轨迹数据包含关于客户的丰富信息，并且将轨迹纳入到流失预测中有很大的潜力。因此，我们提出了一种基于轨迹的深度序列方法TR-LSTM来进行流失预测。在新方法TR-LSTM中，从轨迹数据集中提取三种基于轨迹的特征，然后利用LSTM神经网络进行序列建模。我们进一步在真实客户数据集上展开实证实验。在所有的技术中，我们的方法取得了最好的效果。结果还表明，该方法的优点在于基于轨迹的特征、顺序建模和协作建模。在未来的工作中，我们将探索更有效的指标，以及特征的不同表示。
